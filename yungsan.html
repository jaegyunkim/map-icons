<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì‚°ê°• CCTV ì‹¤ì‹œê°„ ë·°ì–´</title>
    
    <!-- Video.js CSS -->
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    
    <!-- Tailwind CSS (ìŠ¤íƒ€ì¼ë§ìš©) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- í°íŠ¸: Noto Sans KR -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
        }
        /* Video.js ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
        .video-js .vjs-big-play-button {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            border: 2px solid #fff;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            line-height: 76px;
        }
        .vjs-matrix .vjs-big-play-button { /* í…Œë§ˆ ìŠ¤íƒ€ì¼ ì˜¤ë²„ë¼ì´ë“œ */
            border-radius: 50%;
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ ë“± ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        .status-badge {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- ìƒë‹¨ í—¤ë” ë° ì»¨íŠ¸ë¡¤ ì˜ì—­ -->
    <header class="bg-gray-900 border-b border-gray-700 p-4 shadow-lg z-10">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-2">
                <span class="text-red-500 text-2xl">â—</span>
                <h1 class="text-xl font-bold tracking-wider">ì˜ì‚°ê°• CCTV <span class="text-gray-400 text-sm font-normal">Live Viewer</span></h1>
            </div>
            
            <div class="w-full md:w-auto flex items-center gap-3 bg-gray-800 p-1.5 rounded-lg border border-gray-600">
                <label for="locationSelect" class="pl-2 text-sm text-gray-300 font-medium whitespace-nowrap">ğŸ“· ì¥ì†Œ ì„ íƒ:</label>
                <select id="locationSelect" class="bg-gray-700 text-white text-sm rounded px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-64 border-none cursor-pointer hover:bg-gray-600 transition-colors">
                    <option value="" disabled selected>ì¥ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì˜µì…˜ì´ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
                </select>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ë¹„ë””ì˜¤ ì˜ì—­ -->
    <main class="flex-grow relative bg-black flex items-center justify-center p-4">
        <div class="relative w-full max-w-5xl aspect-video bg-gray-900 rounded-xl overflow-hidden shadow-2xl border border-gray-800">
            
            <!-- ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ -->
            <video id="my_video" class="video-js vjs-default-skin vjs-fluid" controls preload="auto" poster="">
                <p class="vjs-no-js">
                    ì´ ë¹„ë””ì˜¤ë¥¼ ë³´ë ¤ë©´ JavaScriptë¥¼ í™œì„±í™”í•˜ê³  HTML5 ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ëŠ” ì›¹ ë¸Œë¼ìš°ì €ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì„¸ìš”.
                </p>
            </video>

            <!-- ì˜¤ë²„ë ˆì´ ì •ë³´ (íƒ€ì´í‹€ ë° ìƒíƒœ) -->
            <div class="absolute top-4 left-4 right-4 flex justify-between items-start pointer-events-none z-10">
                <div class="bg-black/60 backdrop-blur-sm px-4 py-2 rounded-lg border border-white/10">
                    <h2 id="cctv_title" class="text-lg font-bold text-white drop-shadow-md">CCTVë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
                    <div id="status_msg" class="text-xs text-gray-400 mt-1 font-mono">ì¤€ë¹„ë¨</div>
                </div>
                <div class="status-badge hidden bg-red-600/80 text-white text-xs font-bold px-2 py-1 rounded animate-pulse shadow-lg backdrop-blur-md">
                    LIVE
                </div>
            </div>

        </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="bg-gray-900 text-gray-500 text-xs py-2 text-center border-t border-gray-800">
        <p>ë³¸ CCTV ì˜ìƒì€ ë‚™ë™ê°•í™ìˆ˜í†µì œì†Œì—ì„œ ì œê³µí•˜ëŠ” ê³µê°œ ë°ì´í„°ì…ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœì— ë”°ë¼ ì¬ìƒì´ ì§€ì—°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </footer>

    <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>

    <script>
        // --- 1. CCTV ë°ì´í„° ì†ŒìŠ¤ ì •ì˜ ---
        const cctv_sources = [
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ê·¹ë½êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13003/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ë²½ì§„ë™", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13050/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ì‹ ìš´êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13074/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ìš©ì‚°êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv110014/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ìš©ì§„êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv110016/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ìœ ì´Œêµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13004/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ì¥ë¡êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13000/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ ì²œêµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv13076/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ í‰ë¦¼êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv110020/hls.m3u8" },
            { name: "ê´‘ì£¼ê´‘ì—­ì‹œ í’ì˜ì •ì²œ2êµ", url: "https://cctvlo.yeongsanriver.go.kr/live/cctv110022/hls.m3u8" }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            // Dropdown ì˜µì…˜ ì±„ìš°ê¸°
            const selectElement = document.getElementById('locationSelect');
            cctv_sources.forEach((source, index) => {
                const option = document.createElement('option');
                option.value = index; // ì¸ë±ìŠ¤ë¥¼ ê°’ìœ¼ë¡œ ì‚¬ìš©
                option.textContent = source.name;
                selectElement.appendChild(option);
            });

            // Video.js ì´ˆê¸°í™”
            const player = videojs('my_video', {
                fluid: true, // ë°˜ì‘í˜• í¬ê¸° ì¡°ì ˆ
                controlBar: {
                    children: [
                        'playToggle',
                        'volumePanel',
                        'progressControl', // ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¼ì´ë¼ í° ì˜ë¯¸ëŠ” ì—†ì§€ë§Œ ë²„í¼ í™•ì¸ìš©
                        'fullscreenToggle',
                    ]
                }
            });

            const titleEl = document.getElementById('cctv_title');
            const statusEl = document.getElementById('status_msg');
            const liveBadge = document.querySelector('.status-badge');

            // í”Œë ˆì´ì–´ ì—ëŸ¬ í•¸ë“¤ë§
            player.on('error', function() {
                const error = player.error();
                console.error("Video Error:", error);
                titleEl.classList.add('text-red-400');
                statusEl.textContent = `ì˜¤ë¥˜ ë°œìƒ: ${error.message || "ì—°ê²° ì‹¤íŒ¨"}`;
                statusEl.className = "text-xs text-red-400 mt-1 font-mono";
                liveBadge.classList.add('hidden');
            });

            player.on('playing', function() {
                statusEl.textContent = "â— ì‹¤ì‹œê°„ ì¬ìƒ ì¤‘";
                statusEl.className = "text-xs text-green-400 mt-1 font-mono";
                liveBadge.classList.remove('hidden');
            });
            
            player.on('waiting', function() {
                statusEl.textContent = "ë²„í¼ë§ ì¤‘...";
                statusEl.className = "text-xs text-yellow-400 mt-1 font-mono";
            });

            // ì†ŒìŠ¤ ë³€ê²½ í•¨ìˆ˜
            window.changeCCTVSource = function(index) {
                const source = cctv_sources[index];
                if (!source) return;

                // UI ì—…ë°ì´íŠ¸
                titleEl.textContent = source.name;
                titleEl.classList.remove('text-red-400');
                statusEl.textContent = "ì—°ê²° ì‹œë„ ì¤‘...";
                statusEl.className = "text-xs text-yellow-400 mt-1 font-mono";
                liveBadge.classList.add('hidden');

                // í”Œë ˆì´ì–´ ì†ŒìŠ¤ ì„¤ì •
                player.ready(function() {
                    player.src({
                        src: source.url,
                        type: 'application/x-mpegURL' // HLS íƒ€ì… ì§€ì •
                    });

                    // ì¬ìƒ ì‹œë„
                    const playPromise = player.play();
                    
                    if (playPromise !== undefined) {
                        playPromise
                        .then(() => {
                            // ì¬ìƒ ì‹œì‘ë¨ (playing ì´ë²¤íŠ¸ì—ì„œ UI ì—…ë°ì´íŠ¸)
                        })
                        .catch(error => {
                            console.warn("Autoplay prevented:", error);
                            if (error.name === 'NotAllowedError') {
                                statusEl.textContent = "â–¶ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš” (ìë™ì¬ìƒ ì°¨ë‹¨ë¨)";
                                statusEl.className = "text-xs text-orange-400 mt-1 font-mono";
                            } else {
                                statusEl.textContent = "ì¬ìƒ ì‹¤íŒ¨ (ë„¤íŠ¸ì›Œí¬/ë³´ì•ˆ ë¬¸ì œ ê°€ëŠ¥ì„±)";
                                statusEl.className = "text-xs text-red-400 mt-1 font-mono";
                            }
                        });
                    }
                });
            };

            // ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì´ë²¤íŠ¸
            selectElement.addEventListener('change', function(e) {
                changeCCTVSource(e.target.value);
            });

            // (ì„ íƒ ì‚¬í•­) í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ CCTV ìë™ ë¡œë“œ ì›í•˜ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
            // selectElement.value = "0";
            // changeCCTVSource(0);
        });
    </script>
</body>
</html>